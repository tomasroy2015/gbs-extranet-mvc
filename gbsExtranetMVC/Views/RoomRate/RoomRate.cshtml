@using Resources
@{
    ViewBag.Title = "RoomRate";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1 style="text-align:center;">@Resources.RoomRate</h1>
        <style>
            .GridTable {
                border-collapse: collapse;
            }

            .GridTable {
                border-width: 1px;
                border-style: solid;
                border-color: #CCCCCC;
                border-collapse: collapse;
                background-color: #ebf4f8;
            }

                .GridTable th {
                    border-width: 1px;
                    padding: 1px;
                    border-style: inset;
                    border-color: gray;
                    background-color: white;
                    /*-moz-border-radius:;*/
                }

                .GridTable td {
                    border-width: 1px;
                    padding: 1px;
                    border-style: solid;
                    border-color: #CCCCCC;
                    /*-moz-border-radius:;*/
                }

            .GridBar {
                background-color: #F7F2E0;
                color: navy;
                font-weight: bold;
            }

            .GridBar2 {
                background-color: #ede8d7;
                color: Maroon;
                font-weight: bold;
                padding: 5px;
                border: 1px solid #c5ccda;
            }

            .GridBar3 {
                background-color: #F7F2E0;
                color: #DF7401;
                font-weight: bold;
                padding: 3px;
            }

            .GridBar4 {
                background-color: #F7F2E0;
                color: green;
                font-weight: bold;
            }

            .Available {
                background-color: #e8eefb;
                width: 20px;
            }

            .Closed {
                background-color: red;
                width: 20px;
            }

            .Full {
                background-color: yellow;
                width: 20px;
            }

            .RateMissing {
                background-color: #fbeec5;
                width: 20px;
            }

            .BlueBar {
                background-color: #c4daed;
                color: Navy;
                font-weight: bold;
                height: 25px;
                padding-left: 10px;
                padding-right: 10px;
                padding-top: 5px;
                padding-bottom: 5px;
            }

            .NoWrap {
                white-space: nowrap;
            }

            .divCaption {
                margin-left: 5px;
                margin-top: 3px;
                font-weight: bold;
                color: black;
                font-size: 14px;
            }
        </style>

        <div class="jumbotron" style="text-align: left; margin-bottom: 50px;border-radius:8px;padding: 10px;font-size: 14px;font-weight: 100;line-height: 1.142857;">
            <div class="row" style="margin-bottom: 12px;">
                <div class="col-md-12">
                    <div class="col-md-8">
                        <div class="row" style="padding-top: 15px; margin-left: 20px; display: flex;">
                            <label style="width: 180px; padding-top: 7px;">@Resources.StartDate</label>
                            <input type="text" id="datetimepickerStart" value="@ViewBag.StartDate" placeholder="@Resources.DateFieldDescription" onblur="CheckTodayDate()" style=" width: 170px; height: 25px; " />&nbsp;&nbsp;
                            <label style="margin-top: 6px;" class="requiredfield" for="">*</label>
                            <label id="lblTodayComparisionWarning" style="color: red; font-size: medium; display: none; margin: 5px;">@Resources.TodayComparisionWarning</label>
                        </div>
                        <div class="row" style="padding-top: 15px; margin-left: 20px; display: flex; ">
                            <label style="width: 180px; padding-top: 7px; ">@Resources.EndDate</label>
                            <input type="text" id="datetimepickerEnd" value="@ViewBag.EndDate" placeholder="@Resources.DateFieldDescription" onblur="CheckDate()" style=" width: 170px; height: 25px;" />&nbsp;&nbsp;
                            <label style="margin-top: 6px;" class="requiredfield" for="">*</label>
                            <label id="lblDateComparisionWarning" style="color: red; font-size: medium; display: none; margin: 5px; ">@Resources.DateComparisionWarning</label>
                        </div>
                        <div class="row" style="padding-top: 15px; margin-left: 20px; display: flex;">
                            <label style="width: 180px; padding-top: 7px; ">@Resources.RoomType</label>
                            <select style="width:170px;" id="ddlRoomType"></select>
                        </div>
                        <div class="row" style="padding-top: 15px; margin-left: 20px; display: flex;">
                            <label style="width: 180px; padding-top: 7px; ">@Resources.PricePolicy</label>
                            <select style=" width: 170px;" id="ddlPricePolicy"></select>
                        </div>
                        <div class="row" style="padding-top: 15px; margin-left: 20px; display: flex;">
                            <label style="width: 180px; padding-top: 7px; ">@Resources.AccommodationType</label>
                            <select style=" width: 170px;" id="ddlTypeAccommodation"></select>
                        </div>
                    </div>
                    <div class="col-md-4" style="margin-top: 90px;">
                        <button id="btnLongPeriodRoomRate" class="k-button btn btn-info" onclick="LoadHotelRate(2)">@Resources.LongPeriodRoomRate</button>
                        <button style="display:none" id="btnDailyRoomRate" class="k-button btn btn-info" onclick="LoadHotelRate(1)">@Resources.DailyRoomRate</button>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: 15px;" align="center">
                <button id="btnShow" class="k-button btn btn-info" onclick="LoadHotelRate(1)">@Resources.Show</button>
            </div>
        </div>

        <div align="center">
            <label style="color: Blue; font-size: 15pt; font-weight: bold"> @Resources.Currency : @ViewBag.CurrencyName</label>
        </div>
        <div class="col-md-12" align="left" id="rowLegend" style="display:none">
            <div class="row">
                <div class="col-md-2" style=" display: flex;">
                    <div style="width: 25px; height: 25px; border: 1px solid #c5ccda;background-color: #e8eefb;"></div>
                    <label class="divCaption">@Resources.Available</label>
                </div>
                <div class="col-md-2" style=" display: flex;">
                    <div style="width: 25px; height: 25px; border: 1px solid #c5ccda; background-color:red;"></div>
                    <label class="divCaption">@Resources.Closed</label>
                </div>
                <div class="col-md-2" style=" display: flex;">
                    <div style="width: 25px; height: 25px; border: 1px solid #c5ccda; background-color: #fbeec5; "></div>
                    <label style="margin-top:0px;" class="divCaption">@Resources.RateMissing</label>
                </div>
                <div class="col-md-2" style=" display: flex;">
                    <div style="width: 25px; height: 25px; border: 1px solid #c5ccda; background-color: yellow; "></div>
                    <label class="divCaption">@Resources.Full</label>
                </div>
            </div>

        </div>

        <div class="col-md-12" id="divrowlong">
            <table class="Table col-md-12" width="100%">
                <tr id="rowDailyRoomRate" style="display:none">
                    <td valign="top">
                        <table width="100%" class="Table" border="0" cellpadding="0" cellspacing="0" id="DayRoom"></table>
                    </td>
                </tr>
                <tr id="rowLongPeriodRoomRate" style="display:none">
                    <td valign="top">
                        <table width="100%" class="Table" border="0" cellpadding="0" cellspacing="0" id="tblrowLongPeriodRoomRate"></table>
                    </td>
                </tr>
                <tr>
                    <td align="center">
                        <label id="lblSuccess" style="color:green;font-size:medium;display:none;">@Resources.OperationSuccess</label> <br />
                    </td>
                </tr>
                <tr height="60">
                    <td align="center">
                        <button id="btnShowDailyRoomPrice" style="display:none" class="k-button btn btn-info" onclick="Save(1)">@Resources.Save</button>
                        <button id="btnShowLongTermRoomPrice" style="display:none" class="k-button btn btn-info" onclick="Save(2)">@Resources.Save</button>
                    </td>
                </tr>

            </table>
        </div>


        <div class="col-md-12">
            <table class="Table col-md-12" width="100%">
                <tr>
                    <td align="center">
                        <label id="lblnodata" style="color:green;font-size:medium;display:none;">@Resources.Noroomsavailable</label> <br />
                    </td>
                </tr>
            </table>
        </div>
        <script>

            var HotelRoomID = '@ViewBag.HotelRoomID';
            // alert(HotelRoomID)

            if (HotelRoomID != "") {
                setTimeout("drptype(HotelRoomID)", 1000);
            }
            function drptype(HotelRoomID) {
                // alert(HotelRoomID)
                var HotelChain = $("#ddlRoomType").data("kendoDropDownList");
                HotelChain.select(HotelRoomID);
            }

            function isNumberKey(evt) {
                var charCode = (evt.which) ? evt.which : event.keyCode
                //alert(charCode)
                if (charCode > 31 && (charCode < 48 || charCode > 57))
                    return false;

                return true;
            }

            $(document).ready(function () {
                setTimeout("LoadHotelRate(1)", 2000);
            });

            function Save(Mode) {
                // alert(Mode)

                var StartDate = document.getElementById('datetimepickerStart').value
                var Enddate = document.getElementById('datetimepickerEnd').value
                var RoomType = document.getElementById('ddlRoomType').value
                var PricePolicy = document.getElementById('ddlPricePolicy').value
                var AccommodationType = document.getElementById('ddlTypeAccommodation').value

                if (Mode == 1) {

                    var RoomID = document.getElementsByName("hidhotelRoomID");

                    var RoomIDArray = [];
                    var DateIDArray = [];
                    var SinglePriceArray = [];
                    var DoublePriceArray = [];
                    var RoomPriceArray = [];


                    for (var i = 0; i < RoomID.length; i++) {
                        //alert(RoomID[i].value)

                        if (RoomIDArray.indexOf(RoomID[i].value) == -1) {
                            DateIDArray = [];
                            SinglePriceArray = [];
                            DoublePriceArray = [];
                            RoomPriceArray = [];
                            //alert(RoomID[i].value)
                            RoomIDArray.push(RoomID[i].value);
                            var HotelRoomID = RoomID[i].value;
                            // alert(RoomID[i].value);
                            var MaxPeopleCount = document.getElementById("hidMaxPeopleCount" + RoomID[i].value).value;
                            //alert(MaxPeopleCount)
                            var DateID = document.getElementsByName("hidDateID" + RoomID[i].value);
                            var SinglePrice = document.getElementsByName("txtSinglePrice" + RoomID[i].value);

                            if (MaxPeopleCount > 1) {
                                var DoublePrice = document.getElementsByName("txtDoublePrice" + RoomID[i].value);
                            }
                            if (MaxPeopleCount > 2) {
                                var RoomPrice = document.getElementsByName("txtRoomPrice" + RoomID[i].value);
                            }


                            for (var j = 0; j < DateID.length; j++) {
                                //alert(j)
                                //alert(SinglePrice[j].value)
                                DateIDArray.push(DateID[j].value);
                                SinglePriceArray.push(SinglePrice[j].value)
                                // alert(SinglePriceArray)
                                if (MaxPeopleCount > 1) {
                                    DoublePriceArray.push(DoublePrice[j].value)
                                }
                                if (MaxPeopleCount > 2) {
                                    RoomPriceArray.push(RoomPrice[j].value)
                                }

                            }
                            var json = { Mode: Mode, StartDate: StartDate, Enddate: Enddate, RoomType: RoomType, PricePolicy: PricePolicy, AccommodationType: AccommodationType, DateIDArray: [DateIDArray], HotelRoomID: HotelRoomID, SinglePriceArray: [SinglePriceArray], DoublePriceArray: [DoublePriceArray], RoomPriceArray: [RoomPriceArray], MaxPeopleCount: MaxPeopleCount }
                            if (RoomType == "") {
                                //alert(RoomType)
                                if (HotelRoomID != "") {
                                    //alert('hi')

                                    $.ajax({
                                        type: "GET",
                                        url: "/RoomRate/SaveDailyRoomRate",
                                        data: json,
                                        datatype: "json",
                                        traditional: "true",
                                        success: function (data) {
                                            document.getElementById("lblSuccess").style.display = "";
                                            setTimeout("Hidelabel(1)", 2000);
                                            //LoadHotelRate(1);
                                        }
                                    });
                                }
                            }
                            else if (RoomType == HotelRoomID) {
                                //  alert(RoomType)
                                if (HotelRoomID != "") {
                                    //alert('hi')

                                    $.ajax({
                                        type: "GET",
                                        url: "/RoomRate/SaveDailyRoomRate",
                                        data: json,
                                        datatype: "json",
                                        traditional: "true",
                                        success: function (data) {
                                            // LoadHotelRate(1);
                                            document.getElementById("lblSuccess").style.display = "";
                                            setTimeout("Hidelabel(1)", 2000);
                                        }
                                    });
                                }
                            }

                        }

                    }
                }


                if (Mode == 2) {

                    var RoomID = document.getElementsByName("hidRoomID");

                    var RoomIDArray = [];
                    var SinglePriceArray = [];
                    var DoublePriceArray = [];
                    var RoomPriceArray = [];

                    if (RoomType == "") {
                        //alert(RoomType)
                        for (var i = 0; i < RoomID.length; i++) {

                            var HotelRoomID = RoomID[i].value;
                            var SinglePrice = document.getElementById("lblSinglePrice" + HotelRoomID).value;
                            var DoublePrice = document.getElementById("lblDoublePrice" + HotelRoomID).value;
                            var RoomPrice = document.getElementById("lblRoomPrice" + HotelRoomID).value;

                            var json = { Mode: Mode, StartDate: StartDate, Enddate: Enddate, RoomType: RoomType, PricePolicy: PricePolicy, AccommodationType: AccommodationType, HotelRoomID: HotelRoomID, SinglePrice: SinglePrice, DoublePrice: DoublePrice, RoomPrice: RoomPrice }

                            $.ajax({
                                type: "GET",
                                url: "/RoomRate/SaveRoomRate",
                                data: json,
                                datatype: "json",
                                traditional: "true",
                                success: function (data) {
                                    document.getElementById("lblSuccess").style.display = "";
                                    setTimeout("Hidelabel(2)", 2000);
                                    //LoadHotelRate(2);
                                }
                            });

                        }
                    }
                    else if (RoomType != "") {
                        // alert(RoomType)
                        var HotelRoomID = RoomType;
                        var SinglePrice = document.getElementById("lblSinglePrice" + HotelRoomID).value;
                        var DoublePrice = document.getElementById("lblDoublePrice" + HotelRoomID).value;
                        var RoomPrice = document.getElementById("lblRoomPrice" + HotelRoomID).value;

                        var json = { Mode: Mode, StartDate: StartDate, Enddate: Enddate, RoomType: RoomType, PricePolicy: PricePolicy, AccommodationType: AccommodationType, HotelRoomID: HotelRoomID, SinglePrice: SinglePrice, DoublePrice: DoublePrice, RoomPrice: RoomPrice }

                        $.ajax({
                            type: "GET",
                            url: "/RoomRate/SaveRoomRate",
                            data: json,
                            datatype: "json",
                            traditional: "true",
                            success: function (data) {
                                // LoadHotelRate(2);
                                document.getElementById("lblSuccess").style.display = "";
                                setTimeout("Hidelabel(2)", 2000);
                            }
                        });
                    }
                }

            }

            function Hidelabel(Mode) {
                document.getElementById("lblSuccess").style.display = "none";
                LoadHotelRate(Mode);
            }


            function LoadHotelRate(Mode) {
                //alert(Mode)
                $("#lblnodata").hide();
                var StartDate = document.getElementById('datetimepickerStart').value
                var Enddate = document.getElementById('datetimepickerEnd').value
                var RoomType = document.getElementById('ddlRoomType').value
                var PricePolicy = document.getElementById('ddlPricePolicy').value
                var AccommodationType = document.getElementById('ddlTypeAccommodation').value


                if (StartDate != "" && Enddate != "" && DateValidationToday == "Valid" && DateValidationDiff == "Valid") {
                    var json = { Mode: Mode, StartDate: StartDate, Enddate: Enddate, RoomType: RoomType, PricePolicy: PricePolicy, AccommodationType: AccommodationType }

                    if (Mode == 1) {
                        document.getElementById("rowDailyRoomRate").style.display = '';
                        document.getElementById("rowLongPeriodRoomRate").style.display = 'none';

                        document.getElementById("btnShowDailyRoomPrice").style.display = '';
                        document.getElementById("btnShowLongTermRoomPrice").style.display = 'none';

                        document.getElementById("btnDailyRoomRate").style.display = 'none';
                        document.getElementById("btnLongPeriodRoomRate").style.display = '';

                        document.getElementById("btnShow").style.display = '';
                        document.getElementById("rowLegend").style.display = '';

                        $.ajax({
                            type: "GET",
                            url: "/RoomRate/LoadHotelRate",
                            data: json,
                            datatype: "json",
                            traditional: "true",
                            success: function (data) {
                                // alert(data)
                                $("#DayRoom").empty();
                                var DateArray = [];
                                var RoomIDArray = [];
                                var Count = 0;
                                if (data != "") {

                                    $.each(data, function (key, val) {
                                        // alert(val.txtSinglePrice)
                                        //  alert(val.txtDoublePrice)

                                        if (RoomIDArray.indexOf(val.HotelRoomID) == -1) {

                                            RoomIDArray.push(val.HotelRoomID)
                                            $("#DayRoom").append(
                                                (Count == 0 ? '<tr style="height:25px" id="GridBarRow">' +
                                                    '<td class="GridBar2">' +
                                                        '&nbsp;' +
                                                        '</td>' +
                                                '<td class="GridBar2">' +
                                                '<table style="width:100%">' +
                                                '<tr align="center">' +
                                                '<td colspan="3" align="center">' +
                                                    '<label>' + val.RoomTypeName + '</label>' +
                                                '</td>' +
                                                '</tr>' +
                                                '<td class="GridBar3" align="center">' +
                                                '<label>@Resources.SinglePrice</label>' +
                                                '</td>' +
                                                (val.MaxPeopleCount > 1 ? '<td class="GridBar3" align="center">' +
                                                        '<label>@Resources.DoublePrice</label>' +
                                                    '</td>' : '') +
                                                      (val.MaxPeopleCount > 2 ? '<td class="GridBar3" align="center">' +
                                                        '<label>@Resources.RoomPrice</label>' +
                                                    '</td>' : '') +
                                                    '</tr>' : '')
                                                )
                                            if (Count > 0) {
                                                $("#GridBarRow").append(
                                                    '<td class="GridBar2">' +
                                                '<table style="width:100%">' +
                                                '<tr align="center">' +
                                                '<td colspan="3" align="center">' +
                                                    '<label>' + val.RoomTypeName + '</label>' +
                                                '</td>' +
                                                '</tr>' +
                                                '<td class="GridBar3" align="center">' +
                                                '<label>@Resources.SinglePrice</label>' +
                                                '</td>' +
                                                (val.MaxPeopleCount > 1 ? '<td class="GridBar3" align="center">' +
                                                        '<label>@Resources.DoublePrice</label>' +
                                                    '</td>' : '') +
                                                      (val.MaxPeopleCount > 2 ? '<td class="GridBar3" align="center">' +
                                                        '<label>@Resources.RoomPrice</label>' +
                                                    '</td>' : '')
                                                    );
                                            }
                                            Count++;
                                        }



                                        if (DateArray.indexOf(val.DateID) != -1) {
                                            if (val.SinglePrice == null) {
                                                val.SinglePrice = 0;
                                            }
                                            if (val.DoublePrice == null) {
                                                val.DoublePrice = 0;
                                            }
                                            if (val.RoomPrice == null) {
                                                val.RoomPrice = 0;
                                            }

                                            $("#RowRoomDay" + val.DateID).append(
                                                //'<input type="hidden" id="hidDateID" name="hidhotelRoomID" value=' + val.HotelRoomID + ' />' +
                                                //'<td id="cellRoomDay' + val.DateID + '" class="' + val.hotelRoomAvailabilityText + ' GridBar2" align="center" style="border:1px solid #c5ccda;">' +
                                                 (val.hotelRoomAvailabilityText == "Closed" ? '<td id="cellRoomDay" disabled class="' + val.hotelRoomAvailabilityText + ' GridBar2" align="center" style="border:1px solid #c5ccda;">' :
                                                  '<td id="cellRoomDay" class="' + val.hotelRoomAvailabilityText + ' GridBar2" align="center" style="border:1px solid #c5ccda;">') +
                                                    '<table align="center" style="width:100%" border="0" cellpadding="0" cellspacing="0">' +
                                                   '<tr>' +
                                                   '<td   align="center"><input type="hidden" id="hidDateID' + val.HotelRoomID + '" name="hidDateID' + val.HotelRoomID + '" value=' + val.DateID + ' />' +
                                                   '<input type="hidden" id="hidhotelRoomID" name="hidhotelRoomID" value=' + val.HotelRoomID + ' />' +
                                                   '<input type="hidden" id="hidMaxPeopleCount' + val.HotelRoomID + '" name="hidMaxPeopleCount' + val.HotelRoomID + '" value=' + val.MaxPeopleCount + ' />' +
                                                   //'<input type="text" name="txtSinglePrice' + val.HotelRoomID + '" id="txtSinglePrice' + val.HotelRoomID + '"  value=' + val.SinglePrice + ' style="height:30px;width:60px;" /></td>' +
                                                   //(val.MaxPeopleCount > 1 ? '<td  align="center"><input type="text"  name="txtDoublePrice' + val.HotelRoomID + '" id="txtDoublePrice' + val.HotelRoomID + '" value=' + val.DoublePrice + ' style="height:30px;width:60px;"/></td>' : '') +
                                                   //(val.MaxPeopleCount > 2 ? '<td  align="center"><input type="text"  name="txtRoomPrice' + val.HotelRoomID + '"  id="txtRoomPrice' + val.HotelRoomID + '" value=' + val.RoomPrice + ' style="height:30px;width:60px;"/></td>' : '') +
                                                   (val.txtSinglePrice == true ? '<input type="text" name="txtSinglePrice' + val.HotelRoomID + '" id="txtSinglePrice' + val.HotelRoomID + '" value=' + val.SinglePrice + ' style="height:30px;width:60px;" onkeypress="return isNumberKey(event);"  /></td>' :
                                                    val.txtSinglePrice == false ? '<input type="text" disabled name="txtSinglePrice' + val.HotelRoomID + '" id="txtSinglePrice' + val.HotelRoomID + '" value=' + val.SinglePrice + ' style="height:30px;width:60px;" /></td>' : '') +
                                                  (val.MaxPeopleCount > 1 ? '<td  align="center">' +
                                                  (val.txtDoublePrice == true ? '<input type="text"  name="txtDoublePrice' + val.HotelRoomID + '" id="txtDoublePrice' + val.HotelRoomID + '" value=' + val.DoublePrice + ' style="height:30px;width:60px;" onkeypress="return isNumberKey(event);" /></td>' :
                                                  val.txtDoublePrice == false ? '<input type="text" disabled name="txtDoublePrice' + val.HotelRoomID + '" id="txtDoublePrice' + val.HotelRoomID + '" value=' + val.DoublePrice + ' style="height:30px;width:60px;"/></td>' : '')
                                                  : '') +
                                                   (val.MaxPeopleCount > 2 ? '<td  align="center">' +
                                                   (val.txtRoomPrice == true ? '<input type="text"  name="txtRoomPrice' + val.HotelRoomID + '"  id="txtRoomPrice' + val.HotelRoomID + '" value=' + val.RoomPrice + ' style="height:30px;width:60px;" onkeypress="return isNumberKey(event);" /></td>' :
                                                   val.txtRoomPrice == false ? '<input type="text" disabled name="txtRoomPrice' + val.HotelRoomID + '"  id="txtRoomPrice' + val.HotelRoomID + '" value=' + val.RoomPrice + ' style="height:30px;width:60px;"/></td>' : '')

                                                   : '') +
                                               '</tr>' +
                                            '</table>' +
                                            '</td>'
                                                );
                                        }
                                        if (DateArray.indexOf(val.DateID) == -1) {
                                            if (val.SinglePrice == null) {
                                                val.SinglePrice = 0;
                                            }
                                            if (val.DoublePrice == null) {
                                                val.DoublePrice = 0;
                                            }
                                            if (val.RoomPrice == null) {
                                                val.RoomPrice = 0;
                                            }

                                            $("#DayRoom").append(
                                                '<tr id="RowRoomDay' + val.DateID + '">' +
                                        '<td class="GridBar2" width="1%" style="white-space:nowrap;padding:10px;">' +
                                          '<label>' + val.Day + ' ' + val.MonthName + ' ' + val.Year + '</label>' +
                                          '<input type="hidden" id="hidDateID' + val.HotelRoomID + '" name="hidDateID' + val.HotelRoomID + '" value=' + val.DateID + ' />' +
                                          '<input type="hidden" id="hidhotelRoomID" name="hidhotelRoomID" value=' + val.HotelRoomID + ' />' +
                                          '<input type="hidden" id="hidMaxPeopleCount' + val.HotelRoomID + '" name="hidMaxPeopleCount' + val.HotelRoomID + '" value=' + val.MaxPeopleCount + ' />' +
                                    '</td>' +
                                    (val.hotelRoomAvailabilityText == "Closed" ? '<td id="cellRoomDay" disabled class="' + val.hotelRoomAvailabilityText + ' GridBar2" align="center" style="border:1px solid #c5ccda;">' :
                                    '<td id="cellRoomDay" class="' + val.hotelRoomAvailabilityText + ' GridBar2" align="center" style="border:1px solid #c5ccda;">') +

                                           '<table align="center" style="width:100%" border="0" cellpadding="0" cellspacing="0">' +
                                               '<tr>' +
                                                   '<td  align="center">' +
                                                   (val.txtSinglePrice == true ? '<input type="text" name="txtSinglePrice' + val.HotelRoomID + '" id="txtSinglePrice' + val.HotelRoomID + '" value=' + val.SinglePrice + ' style="height:30px;width:60px;" onkeypress="return isNumberKey(event);" /></td>' :
                                                    val.txtSinglePrice == false ? '<input type="text" disabled name="txtSinglePrice' + val.HotelRoomID + '" id="txtSinglePrice' + val.HotelRoomID + '" value=' + val.SinglePrice + ' style="height:30px;width:60px;" /></td>' : '') +
                                                  (val.MaxPeopleCount > 1 ? '<td  align="center">' +
                                                  (val.txtDoublePrice == true ? '<input type="text"  name="txtDoublePrice' + val.HotelRoomID + '" id="txtDoublePrice' + val.HotelRoomID + '" value=' + val.DoublePrice + ' style="height:30px;width:60px;" onkeypress="return isNumberKey(event);" /></td>' :
                                                  val.txtDoublePrice == false ? '<input type="text" disabled name="txtDoublePrice' + val.HotelRoomID + '" id="txtDoublePrice' + val.HotelRoomID + '" value=' + val.DoublePrice + ' style="height:30px;width:60px;"/></td>' : '')
                                                  : '') +
                                                   (val.MaxPeopleCount > 2 ? '<td  align="center">' +
                                                   (val.txtRoomPrice == true ? '<input type="text"  name="txtRoomPrice' + val.HotelRoomID + '"  id="txtRoomPrice' + val.HotelRoomID + '" value=' + val.RoomPrice + ' style="height:30px;width:60px;" onkeypress="return isNumberKey(event);" /></td>' :
                                                  val.txtRoomPrice == false ? '<input type="text" disabled name="txtRoomPrice' + val.HotelRoomID + '"  id="txtRoomPrice' + val.HotelRoomID + '" value=' + val.RoomPrice + ' style="height:30px;width:60px;"/></td>' : '')

                                                   : '') +
                                               '</tr>' +
                                           '</table>' +
                                       '</td>' +
                                       '</tr>'
                                                );

                                        }
                                        DateArray.push(val.DateID)
                                    });

                                }
                                else {
                                    $("#lblnodata").show();
                                    $("#rowLegend").hide();
                                    $("#divrowlong").hide();
                                }

                            }
                        })
                    }
                    else if (Mode == 2) {

                        document.getElementById("rowDailyRoomRate").style.display = 'none';
                        document.getElementById("rowLongPeriodRoomRate").style.display = '';

                        document.getElementById("btnShowDailyRoomPrice").style.display = 'none';
                        document.getElementById("btnShowLongTermRoomPrice").style.display = '';

                        document.getElementById("btnDailyRoomRate").style.display = '';
                        document.getElementById("btnLongPeriodRoomRate").style.display = 'none';

                        document.getElementById("btnShow").style.display = 'none';
                        document.getElementById("rowLegend").style.display = 'none';

                        $.ajax({
                            type: "GET",
                            url: "/RoomRate/LoadHotelRate",
                            data: json,
                            datatype: "json",
                            traditional: "true",
                            success: function (data) {
                                //alert(data)
                                $("#tblrowLongPeriodRoomRate").empty();
                                if (data != "") {

                                    $("#tblrowLongPeriodRoomRate").append(
                                            '<tr class="GridBar2" height="35px" align="center">' +
                                                '<td style="border:1px solid #c5ccda;">' +
                                                 '&nbsp;' +
                                                 '</td>' +
                                                '<td style="border:1px solid #c5ccda;color:Green;">' +
                                                      '<label>@Resources.SinglePrice</label>' +
                                                '</td>' +
                                                '<td style="border:1px solid #c5ccda;color:Green;">' +
                                                    '<label>@Resources.DoublePrice</label>' +
                                                '</td>' +
                                                '<td style="border:1px solid #c5ccda;color:Green;">' +
                                                '<label>@Resources.RoomPrice</label>' +
                                                '</td>' +
                                            '</tr>');
                                    $.each(data, function (key, val) {
                                        $("#tblrowLongPeriodRoomRate").append(
                                        '<tr height="50px">' +
                                '<td class="GridBar2" width="200px">' +
                                    '<label id="lblRoomTypeName">' + val.RoomTypeName + '</label>' +
                                     '<input type="hidden" id="hidRoomID" name="hidRoomID" value="' + val.HotelRoomID + '"/>' +
                                '</td>' +
                                '<td class="GridBar3" style="border:1px solid #c5ccda;" align="center">' +
                                (val.txtSinglePrice == true ? '<input type="text" style="height:30px;width:60px;" name="lblSinglePrice' + val.HotelRoomID + '" id="lblSinglePrice' + val.HotelRoomID + '"  onkeypress="return isNumberKey(event);" />' :
                                '<input type="text" disabled style="height:30px;width:60px;" name="lblSinglePrice' + val.HotelRoomID + '" id="lblSinglePrice' + val.HotelRoomID + '" />') +
                                //'<input type="text" style="height:30px;width:60px;" id="lblSinglePrice' + val.HotelRoomID + '" />' +
                                '</td>' +
                                 '<td class="GridBar3" style="border:1px solid #c5ccda;" align="center">' +
                                 (val.txtDoublePrice == true ? '<input type="text" style="height:30px;width:60px;" name="lblDoublePrice' + val.HotelRoomID + '" id="lblDoublePrice' + val.HotelRoomID + '" onkeypress="return isNumberKey(event);"  />' :
                                 '<input type="text" disabled style="height:30px;width:60px;" name="lblDoublePrice' + val.HotelRoomID + '" id="lblDoublePrice' + val.HotelRoomID + '"  />') +
                                //'<input type="text" style="height:30px;width:60px;" id="lblDoublePrice' + val.HotelRoomID + '"  />' +
                                '</td>' +
                                 '<td class="GridBar3" style="border:1px solid #c5ccda;" align="center">' +
                                 (val.txtRoomPrice == true ? '<input type="text" style="height:30px;width:60px;" name="lblRoomPrice' + val.HotelRoomID + '" id="lblRoomPrice' + val.HotelRoomID + '" onkeypress="return isNumberKey(event);" />' :
                                 '<input type="text" disabled style="height:30px;width:60px;" name="lblRoomPrice' + val.HotelRoomID + '" id="lblRoomPrice' + val.HotelRoomID + '" />') +
                                //'<input type="text" style="height:30px;width:60px;" id="lblRoomPrice' + val.HotelRoomID + '" />' +
                                '</td>' +
                            '</tr>');
                                    });
                                }
                                else {
                                    $("#lblnodata").show();
                                    $("#rowLegend").hide();
                                    $("#divrowlong").hide();
                                }
                            }
                        })

                    }

                }


            }

            var DateValidationToday = "Valid";

            var DateValidationDiff = "Valid";

            function CheckTodayDate() {

                var StartDate = document.getElementById('datetimepickerStart').value

                var jsonStart = { StartDate: StartDate }
                if (StartDate != "") {
                    // alert(StartDate)
                    $.ajax({
                        type: "GET",
                        url: "/RoomRateAndAvailability/CheckTodayDate",
                        data: jsonStart,
                        datatype: "json",
                        success: function (data) {
                            //alert("TodayDate" + data)
                            if (data >= 1) {
                                document.getElementById("lblTodayComparisionWarning").style.display = "";
                                DateValidationToday = "Invalid"
                            }
                            else {
                                document.getElementById("lblTodayComparisionWarning").style.display = "none";
                                DateValidationToday = "Valid"
                            }
                        }
                    })
                }
            }
            var enddate90 = '@ViewBag.EndDate90';
            function CheckDateDifference() {

                var StartDate = document.getElementById('datetimepickerStart').value
                var Enddate = document.getElementById('datetimepickerEnd').value
                var json = { StartDate: StartDate, Enddate: Enddate }
                if (StartDate != "" && Enddate != "") {
                    // alert("hi")
                    // alert(json)
                    $.ajax({
                        type: "GET",
                        url: "/RoomRateAndAvailability/CheckDateDiff",
                        data: json,
                        datatype: "json",
                        success: function (data) {
                            //alert("TodayDateDiff" + data)
                            if (data >= 1) {
                                document.getElementById("lblDateComparisionWarning").style.display = "";
                                DateValidationDiff = "Invalid"
                            }
                            else {
                                if (data < -90) {
                                    document.getElementById('datetimepickerEnd').value = enddate90;
                                }
                                document.getElementById("lblDateComparisionWarning").style.display = "none";
                                DateValidationDiff = "Valid"
                            }

                        }
                    })
                }
            }


            $(document).ready(function () {
                $("#datetimepickerStart").kendoDatePicker({
                    animation: {
                        close: {
                            effects: "zoom:out",
                            duration: 300
                        }
                    }
                });
                $("#datetimepickerEnd").kendoDatePicker({
                    animation: {
                        close: {
                            effects: "zoom:out",
                            duration: 300
                        }
                    }
                });
            })

            var json = {}
            $.ajax({
                type: "GET",
                url: "/DropDownLists/GetRoomsByHotel",
                data: json,
                datatype: "json",
                success: function (data) {

                    $("#ddlRoomType").kendoDropDownList({
                        dataTextField: "RoomTypeName",
                        dataValueField: "RoomID ",
                        dataSource: data,
                        optionLabel: "@Resources.All"
                    });

                }
            })
            $.ajax({
                type: "GET",
                url: "/DropDownLists/GetPricePlicy",
                data: json,
                datatype: "json",
                success: function (data) {

                    $("#ddlPricePolicy").kendoDropDownList({
                        dataTextField: "Name",
                        dataValueField: "ID",
                        dataSource: data
                    });

                }
            })
            $.ajax({
                type: "GET",
                url: "/DropDownLists/GetAccomodationByID",
                data: json,
                datatype: "json",
                success: function (data) {

                    $("#ddlTypeAccommodation").kendoDropDownList({
                        dataTextField: "Name",
                        dataValueField: "ID",
                        dataSource: data
                    });

                }
            })
        </script>



<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-63530100-1', 'auto');
    ga('send', 'pageview');

</script>